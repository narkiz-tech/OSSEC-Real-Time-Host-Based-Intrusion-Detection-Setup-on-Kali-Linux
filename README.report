# ğŸ›¡ï¸ OSSEC Real-Time Host Monitoring on Kali Linux

**Author:** Narkis Abdibekova
**Date:** July 2025
**License:** MIT

---

## ğŸ“Œ Project Overview

This project demonstrates the **installation, configuration, and testing of OSSEC (Open Source Host-Based Intrusion Detection System)** on a Kali Linux virtual machine.

The lab focuses on **real-time log monitoring**, alert generation, and basic **active response capabilities**, simulating how a **Security Operations Center (SOC)** analyst detects and validates suspicious activity on a Linux host.

A common attack scenario â€” **SSH brute-force authentication attempts** â€” was used to validate detection accuracy and alert severity.

> âš ï¸ **Disclaimer:**
> This project was conducted in a controlled lab environment for defensive security learning purposes only.

---

## ğŸ¯ Objectives

* Install OSSEC on a Kali Linux virtual machine
* Configure OSSEC to monitor critical system logs (e.g. SSH authentication)
* Simulate suspicious activity to validate alert generation
* Demonstrate OSSECâ€™s **active response** capabilities
* Document the workflow using real terminal output

---

## ğŸ”§ Lab Environment

* **Operating System:** Kali Linux (VirtualBox)
* **Hostname:** `kali`
* **User:** `narkis`
* **Security Tool:** OSSEC HIDS *(Wazuh fork not used)*
* **Terminal Prompt:**

  ```bash
  (narkisã‰¿kali)-[~]
  ```

---

## ğŸ› ï¸ Installation

### System Preparation

```bash
(narkisã‰¿kali)-[~] 
â””â”€$ sudo apt update && sudo apt install curl build-essential -y
```

### OSSEC Installation

```bash
(narkisã‰¿kali)-[~] 
â””â”€$ curl -O https://bintray.com/ossec/ossec-hids/download_file?file_path=ossec-hids-3.6.0.tar.gz

(narkisã‰¿kali)-[~] 
â””â”€$ tar -xvzf ossec-hids-3.6.0.tar.gz

(narkisã‰¿kali)-[~] 
â””â”€$ cd ossec-hids-3.6.0

(narkisã‰¿kali)-[~/ossec-hids-3.6.0] 
â””â”€$ sudo ./install.sh
```

### Installation Options Selected

* Language: **English**
* Installation type: **Local (standalone)**
* Email notifications: **Disabled**
* Active response: **Enabled**
* System integrity checking: **Enabled**
* Rootkit detection: **Enabled**

---

## âš™ï¸ Configuration

OSSEC was configured to monitor SSH authentication activity by tracking `/var/log/auth.log`.

### Log File Monitoring

```xml
<!-- /var/ossec/etc/ossec.conf -->
<localfile>
  <location>/var/log/auth.log</location>
  <log_format>syslog</log_format>
</localfile>
```

### SSH Detection Rules

SSH-specific detection rules were enabled by including `sshd_rules.xml`:

```xml
<rules>
  <include>sshd_rules.xml</include>
</rules>
```

This allows OSSEC to detect repeated failed authentication attempts and privilege-related anomalies.

---

## â–¶ï¸ Starting OSSEC

```bash
(narkisã‰¿kali)-[~] 
â””â”€$ sudo /var/ossec/bin/ossec-control start
```

### Service Status Check

```bash
(narkisã‰¿kali)-[~] 
â””â”€$ sudo /var/ossec/bin/ossec-control status
```

Output confirms all OSSEC components are running:

```
ossec-monitord is running...
ossec-logcollector is running...
ossec-remoted is running...
ossec-syscheckd is running...
ossec-analysisd is running...
ossec-execd is running...
```

---

## ğŸš¨ Alert Testing & Validation

### Simulated Attack: SSH Brute Force

To trigger OSSEC alerts, multiple failed SSH login attempts were generated:

```bash
(narkisã‰¿kali)-[~] 
â””â”€$ for i in {1..10}; do ssh invaliduser@localhost; done
```

### Sample Alert Output

This activity produced a **Level 10** alert indicating a brute-force attempt:

```
** Alert 1625593374.23215: mail - syslog,sshd,
2025 Jul 17 19:22:54 (kali) 192.168.56.101->/var/log/auth.log
Rule: 5710 (level 10) -> 'SSHD brute force trying to get access to the system.'
Src IP: 127.0.0.1
User: invaliduser
```

### Reviewing Alerts

View recent alerts:

```bash
sudo tail -n 50 /var/ossec/logs/alerts/alerts.log
```

Filter SSH-related alerts:

```bash
sudo grep "sshd" /var/ossec/logs/alerts/alerts.log
```

This confirms OSSEC correctly detects and escalates suspicious authentication behaviour.

---

## âš¡ Active Response (Overview)

OSSEC supports automated responses such as **temporary IP blocking**.

Example configuration:

```xml
<active-response>
  <command>host-deny</command>
  <location>local</location>
  <level>10</level>
  <timeout>600</timeout>
</active-response>
```

When enabled, repeated brute-force attempts can result in automatic blocking via `hosts.deny` or firewall rules.

---

## ğŸ” Key Learnings

* OSSEC provides effective **real-time host-based intrusion detection**
* SSH brute-force attempts are reliably detected with appropriate rule configuration
* Log correlation is critical for validating alerts
* Active response can assist with **basic automated containment**
* Host-based monitoring is a core component of defensive security operations

---

## ğŸ” Security Relevance

This project demonstrates foundational skills relevant to **Junior SOC Analyst** and **Cybersecurity Graduate** roles, including:

* Log monitoring and analysis
* Alert triage and validation
* Host-based intrusion detection
* Defensive security configuration



